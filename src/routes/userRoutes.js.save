// src/routes/userRoutes.js
import express from 'express';
import { authenticate } from '../middleware/auth.js'; // Existing Auth
import { authorize } from '../middleware/rbac.js';    // New RBAC Guard

const router = express.Router();

// PUBLIC: Anyone can see the login page or ping the health check
router.get('/health', (req, res) => res.send('System Active'));

// PROTECTED: Any logged-in user can see their own profile
router.get('/profile', authenticate, (req, res) => {
  res.json({ user: req.user });
});

// RESTRICTED: Only Admin/HR can delete a user (AC #3 - Matrix Alignment)
router.delete('/:id', 
  authenticate, 
  authorize('delete:all'), 
  (req, res) => {
    res.json({ message: `User ${req.params.id} deleted successfully` });
  }
);

export default router;
